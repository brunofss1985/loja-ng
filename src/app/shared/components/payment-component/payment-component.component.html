<!-- payment.component.html -->
<header class="header">
  <div class="header-content">
    <div class="logo">üí™ SupleMax</div>
    <div class="breadcrumb">
      <a href="#" (click)="goBack()">Carrinho</a> > Pagamento
    </div>
  </div>
</header>

<div class="container">
  <h1 class="page-title">Finalizar Pedido</h1>
  
  <form [formGroup]="checkoutForm" (ngSubmit)="processPayment()">
    <div class="checkout-container">
      <!-- Formul√°rio Principal -->
      <div class="checkout-form">
        
        <!-- Dados Pessoais -->
        <div class="form-section">
          <h2 class="section-title">üìã Dados Pessoais</h2>
          
          <div class="form-row">
            <div class="form-group">
              <label>Nome Completo *</label>
              <input 
                type="text" 
                formControlName="fullName"
                [class.error]="isFieldInvalid('fullName')"
                placeholder="Seu nome completo">
              <span class="error-message" *ngIf="isFieldInvalid('fullName')">
                {{ getFieldError('fullName') }}
              </span>
            </div>
          </div>
          
          <div class="form-row">
            <div class="form-group">
              <label>Email *</label>
              <input 
                type="email" 
                formControlName="email"
                [class.error]="isFieldInvalid('email')"
                placeholder="seu@email.com">
              <span class="error-message" *ngIf="isFieldInvalid('email')">
                {{ getFieldError('email') }}
              </span>
            </div>
            
            <div class="form-group">
              <label>Telefone *</label>
              <input 
                type="text" 
                formControlName="phone"
                [class.error]="isFieldInvalid('phone')"
                placeholder="(11) 99999-9999"
                (input)="onPhoneInput($event)">
              <span class="error-message" *ngIf="isFieldInvalid('phone')">
                {{ getFieldError('phone') }}
              </span>
            </div>
          </div>
          
          <div class="form-row">
            <div class="form-group">
              <label>CPF *</label>
              <input 
                type="text" 
                formControlName="cpf"
                [class.error]="isFieldInvalid('cpf')"
                placeholder="000.000.000-00"
                (input)="onCpfInput($event)">
              <span class="error-message" *ngIf="isFieldInvalid('cpf')">
                {{ getFieldError('cpf') }}
              </span>
            </div>
          </div>
        </div>

        <!-- Endere√ßo de Entrega -->
        <div class="form-section">
          <h2 class="section-title">üè† Endere√ßo de Entrega</h2>
          
          <div class="form-row">
            <div class="form-group">
              <label>CEP *</label>
              <input 
                type="text" 
                formControlName="cep"
                [class.error]="isFieldInvalid('cep')"
                placeholder="00000-000"
                (input)="onCepInput($event)">
              <span class="error-message" *ngIf="isFieldInvalid('cep')">
                {{ getFieldError('cep') }}
              </span>
            </div>
          </div>
          
          <div class="form-row">
            <div class="form-group flex-2">
              <label>Rua *</label>
              <input 
                type="text" 
                formControlName="street"
                [class.error]="isFieldInvalid('street')"
                placeholder="Nome da rua">
              <span class="error-message" *ngIf="isFieldInvalid('street')">
                {{ getFieldError('street') }}
              </span>
            </div>
            
            <div class="form-group">
              <label>N√∫mero *</label>
              <input 
                type="text" 
                formControlName="number"
                [class.error]="isFieldInvalid('number')"
                placeholder="123">
              <span class="error-message" *ngIf="isFieldInvalid('number')">
                {{ getFieldError('number') }}
              </span>
            </div>
          </div>
          
          <div class="form-row">
            <div class="form-group">
              <label>Complemento</label>
              <input 
                type="text" 
                formControlName="complement"
                placeholder="Apto, bloco, etc.">
            </div>
            
            <div class="form-group">
              <label>Bairro *</label>
              <input 
                type="text" 
                formControlName="neighborhood"
                [class.error]="isFieldInvalid('neighborhood')"
                placeholder="Nome do bairro">
              <span class="error-message" *ngIf="isFieldInvalid('neighborhood')">
                {{ getFieldError('neighborhood') }}
              </span>
            </div>
          </div>
          
          <div class="form-row">
            <div class="form-group">
              <label>Cidade *</label>
              <input 
                type="text" 
                formControlName="city"
                [class.error]="isFieldInvalid('city')"
                placeholder="Nome da cidade">
              <span class="error-message" *ngIf="isFieldInvalid('city')">
                {{ getFieldError('city') }}
              </span>
            </div>
            
            <div class="form-group">
              <label>Estado *</label>
              <select 
                formControlName="state"
                [class.error]="isFieldInvalid('state')">
                <option value="">Selecione</option>
                <option value="SP">S√£o Paulo</option>
                <option value="RJ">Rio de Janeiro</option>
                <option value="MG">Minas Gerais</option>
                <!-- Adicionar outros estados -->
              </select>
              <span class="error-message" *ngIf="isFieldInvalid('state')">
                {{ getFieldError('state') }}
              </span>
            </div>
          </div>
        </div>

        <!-- Forma de Pagamento -->
        <div class="form-section">
          <h2 class="section-title">üí≥ Forma de Pagamento</h2>
          
          <div class="payment-methods">
            <div 
              class="payment-method"
              *ngFor="let method of paymentMethods"
              [class.selected]="selectedPaymentMethod === method.id"
              (click)="selectPaymentMethod(method.id)">
              <span class="payment-icon">{{ method.icon }}</span>
              <span class="payment-name">{{ method.name }}</span>
            </div>
          </div>

          <!-- Dados do Cart√£o -->
          <div class="card-details" *ngIf="selectedPaymentMethod === 'credit' || selectedPaymentMethod === 'debit'">
            <div class="form-row">
              <div class="form-group">
                <label>N√∫mero do Cart√£o *</label>
                <input 
                  type="text" 
                  formControlName="cardNumber"
                  [class.error]="isFieldInvalid('cardNumber')"
                  placeholder="0000 0000 0000 0000"
                  (input)="onCardNumberInput($event)">
                <span class="error-message" *ngIf="isFieldInvalid('cardNumber')">
                  {{ getFieldError('cardNumber') }}
                </span>
              </div>
            </div>
            
            <div class="form-row">
              <div class="form-group">
                <label>Nome no Cart√£o *</label>
                <input 
                  type="text" 
                  formControlName="cardName"
                  [class.error]="isFieldInvalid('cardName')"
                  placeholder="Nome como est√° no cart√£o">
                <span class="error-message" *ngIf="isFieldInvalid('cardName')">
                  {{ getFieldError('cardName') }}
                </span>
              </div>
            </div>
            
            <div class="form-row">
              <div class="form-group">
                <label>Validade *</label>
                <input 
                  type="text" 
                  formControlName="cardExpiry"
                  [class.error]="isFieldInvalid('cardExpiry')"
                  placeholder="MM/AA"
                  (input)="onCardExpiryInput($event)">
                <span class="error-message" *ngIf="isFieldInvalid('cardExpiry')">
                  {{ getFieldError('cardExpiry') }}
                </span>
              </div>
              
              <div class="form-group">
                <label>CVV *</label>
                <input 
                  type="text" 
                  formControlName="cardCvv"
                  [class.error]="isFieldInvalid('cardCvv')"
                  placeholder="000"
                  maxlength="4">
                <span class="error-message" *ngIf="isFieldInvalid('cardCvv')">
                  {{ getFieldError('cardCvv') }}
                </span>
              </div>
            </div>

            <!-- Parcelamento -->
            <div class="installments" *ngIf="selectedPaymentMethod === 'credit'">
              <label>Parcelamento</label>
              <select formControlName="installments">
                <option 
                  *ngFor="let installment of paymentMethods[0].installments" 
                  [value]="installment">
                  {{ installment }}x de {{ formatPrice(getInstallmentPrice()) }}{{ installment === 1 ? ' √† vista' : '' }}
                </option>
              </select>
            </div>
          </div>

          <!-- Informa√ß√µes PIX -->
          <div class="pix-info" *ngIf="selectedPaymentMethod === 'pix'">
            <div class="info-box">
              <h3>üí∞ Pagamento via PIX</h3>
              <p>Ap√≥s confirmar o pedido, voc√™ receber√° o c√≥digo PIX para pagamento.</p>
              <p><strong>Desconto de 5% no PIX!</strong></p>
            </div>
          </div>

          <!-- Informa√ß√µes Boleto -->
          <div class="boleto-info" *ngIf="selectedPaymentMethod === 'boleto'">
            <div class="info-box">
              <h3>üßæ Pagamento via Boleto</h3>
              <p>O boleto ser√° enviado por email e ficar√° dispon√≠vel para impress√£o.</p>
              <p><strong>Prazo de vencimento:</strong> 3 dias √∫teis</p>
            </div>
          </div>
        </div>
      </div>

      <!-- Resumo do Pedido -->
      <div class="order-summary">
        <h2 class="summary-title">üì¶ Resumo do Pedido</h2>
        
        <div class="summary-items">
          <div class="summary-item" *ngFor="let item of orderSummary.items">
            <span class="item-name">{{ item.name }} ({{ item.quantity }}x)</span>
            <span class="item-price">{{ formatPrice(item.price) }}</span>
          </div>
        </div>
        
        <div class="summary-totals">
          <div class="summary-row">
            <span>Subtotal:</span>
            <span>{{ formatPrice(orderSummary.subtotal) }}</span>
          </div>
          
          <div class="summary-row">
            <span>Frete:</span>
            <span>{{ formatPrice(orderSummary.shipping) }}</span>
          </div>
          
          <div class="summary-row" *ngIf="orderSummary.discount > 0">
            <span>Desconto:</span>
            <span class="discount">-{{ formatPrice(orderSummary.discount) }}</span>
          </div>
          
          <div class="summary-row total">
            <span>Total:</span>
            <span>{{ formatPrice(orderSummary.total) }}</span>
          </div>
        </div>
        
        <button 
          type="submit" 
          class="pay-button"
          [disabled]="isProcessing">
          <span *ngIf="!isProcessing">
            <span *ngIf="selectedPaymentMethod === 'credit'">üí≥ Pagar com Cart√£o</span>
            <span *ngIf="selectedPaymentMethod === 'debit'">üí≥ Pagar com D√©bito</span>
            <span *ngIf="selectedPaymentMethod === 'pix'">üì± Pagar com PIX</span>
            <span *ngIf="selectedPaymentMethod === 'boleto'">üßæ Gerar Boleto</span>
          </span>
          <span *ngIf="isProcessing" class="processing">
            ‚è≥ Processando...
          </span>
        </button>
        
        <div class="security-info">
          <p>üîí Seus dados est√£o protegidos</p>
          <p>Transa√ß√£o 100% segura</p>
        </div>
      </div>
    </div>
  </form>
</div>
